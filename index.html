<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculator</title>
  <style>
    :root { --bg:#0f1724; --panel:#0b1220; --accent:#7c3aed; --muted:#94a3b8; --btn:#111827; }
    * { box-sizing:border-box; }
    html, body { height:100%; }
    body {
      margin:0;
      font-family:Segoe UI, system-ui, -apple-system, Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,#071129 0%,#08203a 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      color:#e6eef8;
    }
    .calc {
      background:linear-gradient(180deg,var(--panel),#071224);
      width:360px;
      border-radius:16px;
      padding:18px;
      box-shadow:0 10px 30px rgba(2,6,23,.7);
    }
    .display {
      background:rgba(255,255,255,0.03);
      padding:18px;
      border-radius:10px;
      color:#fff;
      text-align:right;
      word-wrap:break-word;
      min-height:64px;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .small { color:var(--muted); font-size:14px; }
    .big { font-size:28px; line-height:1.1; overflow:hidden; }
    .keys { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-top:14px; }
    button {
      background:var(--btn);
      border:0;
      color:#e6eef8;
      padding:16px;
      font-size:18px;
      border-radius:10px;
      cursor:pointer;
      transition:transform .08s, box-shadow .08s;
    }
    button:active { transform:translateY(1px); }
    .op { background:linear-gradient(180deg,var(--accent),#5b21b6); box-shadow:0 6px 18px rgba(124,58,237,.18); }
    .wide { grid-column:span 2; }
    .secondary { background:rgba(255,255,255,0.03); color:var(--muted); }
    @media (max-width:380px) { .calc { width:100%; } }
  </style>
</head>
<body>
  <main class="calc" role="application" aria-label="Calculator">
    <div class="display" aria-live="polite">
      <div id="expr" class="small">0</div>
      <div id="result" class="big">0</div>
    </div>

    <div class="keys" role="group" aria-label="Calculator keys">
      <button class="secondary" data-action="clear">C</button>
      <button class="secondary" data-action="neg">+/-</button>
      <button class="secondary" data-action="del">DEL</button>
      <button class="op" data-value="/">&#247;</button>

      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="op" data-value="*">&#215;</button>

      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="op" data-value="-">&minus;</button>

      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="op" data-value="+">+</button>

      <button data-value="0" class="wide">0</button>
      <button data-value=".">.</button>
      <button class="op" data-action="equals">=</button>
    </div>
  </main>

  <script>
    const exprEl = document.getElementById("expr");
    const resultEl = document.getElementById("result");

    let expression = "";

    function updateView() {
      exprEl.textContent = expression || "0";
      try {
        if (expression.trim() === "") {
          resultEl.textContent = "0";
          return;
        }
        const val = Function("return (" + expression + ")")();
        resultEl.textContent = (val === undefined || Number.isNaN(val)) ? "Error" : String(val);
      } catch (e) {
        resultEl.textContent = "Error";
      }
    }

    function press(value) {
      if (value === ".") {
        const parts = expression.split(/[^0-9.]/);
        const last = parts[parts.length - 1];
        if (last.includes(".")) {
          return;
        }
      }
      expression += value;
      updateView();
    }

    function clearAll() {
      expression = "";
      updateView();
    }

    function deleteChar() {
      expression = expression.slice(0, -1);
      updateView();
    }

    function toggleNeg() {
      const m = /(-?[\d.]+)$/.exec(expression);
      if (!m) {
        expression = expression ? expression + "-" : "-";
        updateView();
        return;
      }
      const num = m[0];
      const start = expression.slice(0, -num.length);
      expression = num.startsWith("-") ? start + num.slice(1) : start + "-" + num;
      updateView();
    }

    function calculate() {
      try {
        const val = Function("return (" + expression + ")")();
        expression = (val === undefined || Number.isNaN(val)) ? "" : String(val);
      } catch (e) {
        expression = "";
        resultEl.textContent = "Error";
      }
      updateView();
    }

    document.querySelectorAll("button").forEach((b) => {
      b.addEventListener("click", () => {
        const v = b.getAttribute("data-value");
        const a = b.getAttribute("data-action");
        if (a === "clear") return clearAll();
        if (a === "del") return deleteChar();
        if (a === "neg") return toggleNeg();
        if (a === "equals") return calculate();
        if (v) return press(v);
      });
    });

    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" || e.key === "Delete") return clearAll();
      if (e.key === "Backspace") return deleteChar();
      if (e.key === "Enter" || e.key === "=") return calculate();
      if (/^[0-9]$/.test(e.key)) return press(e.key);
      if (e.key === ".") return press(".");
      if (e.key === "+" || e.key === "-" || e.key === "*" || e.key === "/") return press(e.key);
    });

    updateView();
  </script>
</body>
</html>
